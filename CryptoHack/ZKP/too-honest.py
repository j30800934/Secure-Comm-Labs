from pwn import *
from Crypto.Util.number import *
import random 
import json 

host = 'socket.cryptohack.org'
port = 13429
io = remote(host, port, level='DEBUG')

N = 63506177426384102189597350894327047299059434133653566917776601666605133716653510828029111986956978773016660313963972378811186153674164948861199369871734498221215139927864142313488277305751745855210473314367642273303159704466900274761354992859789827863358153922459760984397971477173435625199596782211170294424560686178858124003120741008270927463303483018910205943877584647744143454984243979284973117132536957364157878132874844783228762221620863204335896952103079109039534346621267709606103312376393511653638269034043434410564414042523141936372609708140474052147124354400977541403247799192906955295291389109531010594317
g = 2

k1 = 512
k2 = 128
S = 2**k1
R = 2**(2*k2+k1)

io.recvline()
io.recvline()

e = random.randint(0, 2 ** (2 * k2 + k1))
challenge = {
    "e": e
}
payload = json.dumps(challenge).encode()
io.sendline(payload)

response = json.loads(io.recvline().strip().decode())
z = response["z"]

flag = z // e 
print(long_to_bytes(flag))

io.interactive()

## crypto{2_hon3st_to_b3_tru3}
