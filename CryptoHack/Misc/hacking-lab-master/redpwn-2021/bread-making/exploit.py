#!/usr/bin/env python3
import pwn
import sys

host = "mc.ax"
port = 31796

target = "./bread"

def exploit(remote=False):
    if remote:
        pr = pwn.connect(host, port)
    else:
        pr = pwn.process(target)

    try:
        print(pr.readline())
        pr.sendline('add flour')
        print(pr.readline())
        pr.sendline('add yeast')
        print(pr.readline())
        pr.sendline('add salt')
        print(pr.readline())
        pr.sendline('add water')
        print(pr.readline())
        print(pr.readline())
        pr.sendline('hide the bowl inside a box')
        print(pr.readline())
        print(pr.readline())
        print(pr.readline())
        pr.sendline('wait 3 hours')
        print(pr.readline())
        print(pr.readline())
        print(pr.readline())
        print(pr.readline())
        pr.sendline('work in the basement')
        print(pr.readline())
        print(pr.readline())
        pr.sendline('preheat the toaster oven')
        print(pr.readline())
        print(pr.readline())
        pr.sendline('set a timer on your phone')
        #pr.sendline('use the oven timer')
        print(pr.readline())
        print(pr.readline())
        pr.sendline('watch the bread bake')
        print(pr.readline())
        print(pr.readline())
        print(pr.readline())
        print(pr.readline())
        pr.sendline('pull the tray out with a towel')
        print(pr.readline())
        print(pr.readline())
        print(pr.readline())
        pr.sendline('unplug the oven')
        print(pr.readline())
        print(pr.readline())
        pr.sendline('open the window')
        print(pr.readline())
        print(pr.readline())
        pr.sendline('unplug the fire alarm')
        print(pr.readline())
        print(pr.readline())
        print(pr.readline())
        pr.sendline('clean the counters')
        print(pr.readline())
        pr.sendline('wash the sink')
        print(pr.readline())
        pr.sendline('flush the bread down the toilet')
        print(pr.readline())
        pr.sendline('get ready to sleep')
        print(pr.readline())
        print(pr.readline())
        print(pr.readline())
        pr.sendline('close the window')
        print(pr.readline())
        pr.sendline('replace the fire alarm')
        print(pr.readline())
        pr.sendline('brush teeth and go to bed')
        print(pr.readall(2))
    except Exception:
        pass
    finally:
        pr.close()


remote = False
if len(sys.argv) > 1 and sys.argv[1] == 'remote':
    remote = True
exploit(remote)
# flag{m4yb3_try_f0ccac1a_n3xt_t1m3???0r_dont_b4k3_br3ad_at_m1dnight}
