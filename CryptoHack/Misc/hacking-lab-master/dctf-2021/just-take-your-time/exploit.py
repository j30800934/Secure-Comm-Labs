#!/usr/bin/env python3
import pwn
from time import time
from Crypto.Cipher import DES3


host = "dctf-chall-just-take-your-time.westeurope.azurecontainer.io"
port = 9999

def exploit(remote):
    if remote:
        pr = pwn.connect(host, port)
    else:
        pr = pwn.process(target)

    try:
        pr.readline()
        line = pr.readline().strip().decode().split()
        des3 = DES3.new(str(int(time())).zfill(16).encode("utf-8"),DES3.MODE_CFB, b"00000000")
        a, b = int(line[0]), int(line[2])
        print(a, b)
        pr.sendlineafter('>', str(a*b))
        pr.readline()
        enc = bytes.fromhex(pr.readline().strip().decode())
        dec = des3.decrypt(enc)
        pr.sendlineafter('>', dec)
        print(dec, len(dec))
        print(pr.readline())
        print(pr.readall(2))
    except Exception as e:
        print(e)
    finally:
        pr.close()

exploit(True)
