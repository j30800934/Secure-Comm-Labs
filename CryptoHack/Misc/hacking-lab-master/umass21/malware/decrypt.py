from Crypto.Cipher import AES
from Crypto.Util import Counter
import binascii
import os


def decrypt():

    src = open('malware.py', 'rb').read()
    enc = open('malware.py.enc', 'rb').read()
    enc_flag = open('flag.txt.enc', 'rb').read()

    src = [src[i:i+16] for i in range(0, len(src), 16)]
    enc = [enc[i:i+16] for i in range(0, len(enc), 16)]
    enc_flag = [enc_flag[i:i+16] for i in range(0, len(enc_flag), 16)]

    for i in range(1, 4):
        flag = []
        for j in range(3):
            k = [x^y for x,y in zip(src[i+j], enc[i+j])]
            flag.extend([x^y for x,y in zip(enc_flag[j], k)])
        print(bytes(flag))

decrypt()
