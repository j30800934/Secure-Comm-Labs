#!/usr/bin/env python3
import pwn
import time


host = "35.224.135.84"
port = 2000
target = "guardian-42da85fe8aa8940ca1e461a972ad574d"

def guess(remote, flag):
    if remote:
        pr = pwn.connect(host, port)
    else:
        pr = pwn.process(target)

    try:
        pr.sendlineafter('\n> ', flag)
        ret = 0
        while True:
            line = pr.readline().strip()
            if line.startswith(b'Ho') or line.startswith(b'We'):
                break
            ret += len(line.split())
        return ret
    finally:
        pr.close()

def exploit(remote=False):

    flag = "CCC{"

    while True:
        for a in range(126, 32, -1):
            correct = guess(remote, flag+chr(a))
            if correct == len(flag)+1:
                flag += chr(a)
                print(flag)
                break

        if flag.endswith('}'):
            break

    print(flag)

exploit(True)
